\section{1 BOYUTTA SENSÖR FÜZYONU} \label{1Dfuse}

Çalışmanın bu kısmı, Sensör Sistemi Versiyon 1 ile toplanan veri seti üzerinde ileri yönde tek eksende yapılan hareket baz alınarak yapılmıştır. LiDAR sensörü varyans kestirimi için Kısım (\ref{sec:avr_cost})'de anlatılan ortalama maliyet metodunu kullandık.

Referans pozisyon için kullanılan Aruco işaretleyici verisi, sensörler ile senkronize olmadığı için, sensör verilerinin, referans önçümü alınan zamanlardaki değerlerini interpolasyon yaparak hesapladık. Yine bu zamanlardaki varyans değerlerini ise Denklem (\ref{eq:gauss_rot_var_update})'de birim rotasyon kullanarak elde ettik. 

\subsection{Kullanılan Metotlar}

Sensör değerleri çeşitli çevrimiçi ve çevrimdışı sensör füzyonu metotları kullanılarak karşılaştırılmıştır. Bunlar;

\subsubsection{Çevrimdışı Metotlar}

\paragraph{Sabit \pmb{$\alpha$}} metodunda, sensörlerin füzyondaki ağırlığı sabittir. Bu ağırlık, tüm veri için en küçük kareler yöntemi ile optimum sonucu veren katsayıdır. Sonuç Denklem (\ref{eq:sabit_alpha})'deki gibi hesaplanır.

\begin{equation}\label{eq:sabit_alpha}
    X_{Sabit} = \alpha X_{LiDAR} + (1-\alpha)X_{Stereo}
\end{equation}

Sabit \(\alpha\) metodu çevrim dışı bir metottur ve önerilen çevrimiçi metotların başarılarını kıyaslamak amacı ile eklenmiştir. 

\paragraph{Dinamik \pmb{$\alpha$}} metodunda, her yeni pozisyon verisi için, sensörlerin ağırlıkları Denklem (\ref{eq:dinamik_alpha1})'deki gibi tekrar hesaplanmaktadır. Eğer ilk hesaplanan değer \((0,1)\) aralığı dışındaysa değeri 0 ya da 1 kabul edilir. Bu durum iki sensör de pozisyonun altında ya da üstünde sonuç verdiğinde ortaya çıkmaktadır. Efektif olarak sonuca daha yakın olan sensörün değeri kabul edilir. Füzyon sonucu Denklem (\ref{eq:dinamik_alpha2})'deki gibi hesaplanır.

\begin{equation}\label{eq:dinamik_alpha1}
\begin{split}
f(k) &= \frac{X_{ArUco}(k) - X_{Stereo}(k)}{X_{LiDAR}(k) - X_{Stereo}(k)} \\
\alpha(k) &=
    \begin{cases}
    0, & \text{if } f(k) < 0, \\
    1, & \text{if } f(k) > 1, \\
    f(k), & \text{if } 0 \leq f(k) \leq 1.
    \end{cases}
\end{split}
\end{equation}

\begin{equation}\label{eq:dinamik_alpha2}
    X_{Dinamik}(k) = \alpha(k) X_{LiDAR}(k) + (1-\alpha(k))X_{Stereo}(k)
\end{equation}

Dinamik \(\alpha\) metodu çevrim dışı bir metottur ve sensör sonuçları ile yapılabilmesi mümkün en doğru mutlak pozisyon sonucunu vermektedir. Çünkü, eğer referans pozisyon iki sensör kestiriminin ortasında ise bu değeri, eğer dışındaysa referans pozisyona en yakın sensörün pozisyon değerini vermektedir. Bu nedenle önerilen çevrimiçi metotların başarılarını kıyaslarken bir alt limiti göstermesi amacı ile eklenmiştir. 

\subsubsection{Çevrimiçi Metotlar}

\paragraph{Global ortalama} \label{sec:global_ortalama} metodunda, sensör pozisyonunun ağırlıklı ortalaması alınır. Sensörün ağırlığı, diğer sensörün global varyans değerinin kökü (\(\sigma\)) ile orantılı olacak şekilde belirlenir. Eğer bir sensörün varyansı ne kadar büyükse, yani güvenirliği düşükse, diğer sensöre o kadar çok güvenilir. Sonuç Denklem (\ref{eq:global_alpha})'deki gibi hesaplanır.

\begin{equation}\label{eq:global_alpha}
\begin{split}
\alpha(k) &= \frac{\sigma_{X_{Stereo}}(k)}{\sigma_{X_{Stereo}}(k) + \sigma_{X_{LiDAR}}(k)} \\
    X_{Global}(k) &= \alpha(k) X_{LiDAR}(k) + (1-\alpha(k))X_{Stereo}(k)
\end{split}
\end{equation}


\paragraph{Dönüşüm ortalama} \label{sec:donusum_ortalama}metodunda, sensör dönüşümlerinin ağırlıklı ortalaması alınır. Sensörün ağırlığı, diğer sensörün dönüşüm varyans değerinin kökü \(\sigma\) ile orantılı olacak şekilde belirlenir. Eğer bir sensörün dönüşüm varyansı ne kadar büyükse, yani güvenirliği düşükse, diğer sensöre o kadar çok güvenilir. Sonuç Denklem (\ref{eq:delta_alpha})'deki gibi hesaplanır.

\begin{equation}\label{eq:delta_alpha}
\begin{split}
\alpha(k) &= \frac{\sigma_{T_\text{Stereo}}(k)}{\sigma_{T_\text{Stereo}}(k) + \sigma_{T_\text{LiDAR}}(k)} \\
    X_{\text{Dönüşüm}}(k) &= X_{\text{Dönüşüm}}(k-1) + \alpha(k) T_\text{LiDAR}(k) + (1-\alpha(k))T_\text{Stereo}(k)
\end{split}
\end{equation}

\subsection{Sonuçlar}

Metotlardan elde edilen sonuçları mutlak ve görece hata metrikleri üzerinden karşılaştırdık.

Mutlak hata metriği adından da anlaşılacağı üzere, yapılan kestirimin referans pozisyona olan mutlak uzaklığıdır. Bu metrik çok temel bir karşılaştırma metriği olmakla beraber, deney süresi arttıkça, mutlak pozisyon bilgisi veren bir sensörün olmadığı durumda, bu metriğin ölçtüğü hata miktarı artmaktadır. Bu nedenle farklı senaryolara sahip deneyler, hatta aynı deneyin farklı kısımları arasında karşılaştırma yapmaya elverişli değildir.

Görece hata metriği ise, referans verideki belirli bir değerin üzerinde yapılan her yer değiştirme için yapılan kestirimdeki hatayı ölçer. Bu nedenle zamandan bağımsız bir sonuç verebilir ya da farklı senaryoların kestirime etkisini karşılaştırabilir. Denklem (\ref{eq:relative_error}) ile hesaplanır. Biz çalışmanın burasında referans pozisyonda yapılan her 15 santimetrelik hareket için yapılan kestirimdeki hata yüzdesini ölçtük. Eğer son hesaplamadan beri yapılan yer değiştirme 25 santimetreden düşük ise, o pozisyon için hata hesabı yapılmaz.

\begin{equation}\label{eq:relative_error}
    \textbf{Görece Hata}(k) = |\Delta\textbf{Referans Pozisyon}(k)-\Delta\textbf{Pozisyon Kestirimi}(k)|
\end{equation}

Yöntemlerin 16 deney sonucundaki ortalama performansı Tablo (\ref{tab:1d_avr_ape}) ve (\ref{tab:1d_avr_rpe})'de görülebilir. Ayrıca bu 16 deneyin burada listelemediğimiz sonuçları Ekler'in A Kısmında bulunabilir.

\input{Tables/average_result}
Sonuçları incelediğimizde mutlak hata için hem Dönüşüm hem de Global ortalama metodu Sabit ve Dinamik \(\alpha\) metotlarının gerisinde kalmıştır. Özellikle bu hata metriğinde başarısının daha yüksek olmasını beklediğimiz Global ortalama metodunun Sabit \(\alpha\) metodundan daha kötü performans göstermesi kullandığımız ortalama maliyet üzerinden varyans hesabının ya da bu değer üzerinden yaptığımız global varyans hesabının problemi çözmekte başarısız olduğu anlamına gelmektedir.

Görece hata metriği için ise, Dönüşüm ortalama metodu ortalamada Sabit \(\alpha\) metodunu geride bırakmış hatta kimi zaman deney bazında Dinamik \(\alpha\) metodundan bile daha başarılı sonuç göstermiştir. Deney 11\_07 bunlardan biridir ve bu sonuçlar Tablo (\ref{tab:1d_11_07_rpe})'de görülebilir. Bu metrikte daha başarısız olmasını beklediğimiz Global Ortalama metodu ise beklenenin aksine Dönüşüm Ortalamayı geride bırakmıştır. Ancak Dönüşüm Ortalamanın Dinamik \(\alpha\) metodundan daha başarılı sonuç verdiği deneylerde, Global ortalama Dönüşüm ortalamadan ya daha kötü sonuç vermiş ya da çok küçük farklarla daha başarılı olmuştur. Öte yandan Dönüşüm ortalamanın çok fazla sapma gösterdiği deneylerde de hatasının görece düşük kalması nedeniyle ortalamada daha başarılı olmuştur. Bu durumun sonucu hatanın standart sapmasından da görülebilir. 

\begin{table}[!htb]
    \centering
    \begin{tabular}{|l|r|r|r|r|}
        \hline
        \textbf{} & \textbf{Ort.(m)} & \textbf{Medyan(m)} & \textbf{Std.(m\( ^2\))} & \textbf{RMSE(m)} \\ \hline
		\textbf{Sabit} & 0.1009 & 0.0834 & 0.0045 & 0.1204 \\ \hline
		\textbf{Dinamik} & 0.0963 & 0.0852 & 0.0033 & 0.1117 \\ \hline
		\textbf{Global} & 0.1074 & 0.1297 & 0.0034 & 0.1218 \\ \hline
		\textbf{Dönüşüm} & 0.0723 & 0.0647 & 0.0017 & 0.0826 \\ \hline
    \end{tabular}
    \caption[Kapalı Alan Veriseti deney 11\_07 için Görece Hata Tablosu]{Kapalı Alan Veriseti deney 11\_07 için Görece Hata Tablosu. Tabloda da görüleceği üzere Dönüşüm ortalama metodu bu deney için en düşük ortalama ve RMSE hataya sahiptir.}
    \label{tab:1d_11_07_rpe}
\end{table}

\begin{table}[!htb]
    \centering
    \begin{tabular}{|l|r|r|r|r|}
        \hline
        \textbf{} & \textbf{Ort.(m)} & \textbf{Medyan(m)} & \textbf{Std.(m\( ^2\))} & \textbf{RMSE(m)} \\ \hline
		\textbf{Sabit} & 0.0657 & 0.0606 & 0.0018 & 0.0784 \\ \hline
		\textbf{Dinamik} & 0.0590 & 0.0559 & 0.0021 & 0.0745 \\ \hline
		\textbf{Global} & 0.2382 & 0.2659 & 0.0086 & 0.2555 \\ \hline
		\textbf{Dönüşüm} & 0.1643 & 0.1788 & 0.0058 & 0.1809 \\ \hline
    \end{tabular}
    \caption{ Kapalı Alan Veriseti deney 11\_07 için Mutlak Hata Tablosu}
    \label{tab:1d_11_07_ape}
\end{table}

Ayrıca görece hata, tüm metotlar için başlangıçta yüksekken sonrasında düşme eğilimi göstermiştir. Bu durum Şekil (\ref{fig:1d_11_07}) görece hata görselinde görülebilir. Bunun temel nedeni LiDAR odometrisinde IMU kullanılmadığı için kayma giderme (deskewing) işleminin bir önceki dönüşüm ile elde edilen hız bilgisi ile yapılmasıdır. Robot sabit bir hızla hareket ederken yapılan kayma giderme işlemi, başlangıçtaki ivmeli hareket sırasında yapılan kayma giderme işleminden daha başarılıdır. Bu nedenle bu süreçte yapılan dönüşüm kestirimi de daha başarılı olmaktadır.

\begin{figure}[!h]
    \centering
    \includegraphics[trim=0.9cm 7.3cm 1cm 7cm, clip,width=0.8\linewidth]{Figures/1d_odom/11_07_result.pdf}
   \caption{ Kapalı Alan Veriseti Deney 11\_07 Kestirim Sonucu}
    \label{fig:1d_11_07}
\end{figure}

Bununla birlikte, ortalama maliyet üzerinden yapılan varyans kestiriminin sonuçları genel olarak baktığımızda yeterince tatmin edici değildir. Bu durumun olası bir nedeni, aşırı uyum (overfit) ya da yerel minimuma takılma gibi problemler doğal olarak yapılan kestirimin varyansını arttırırken, optimizasyon probleminde minimize edilmeye çalışılan bu değerin bu problemler sonucunda düşmesi olabilir. Bu yöntemin bir diğer sıkıntısı ise, şu anki hali ile sadece LiDAR Odometrisi bölümü için bir sonuç vermekte, Haritalama ile yapılan düzeltmeleri hesabına dahil etmemektedir. Bu nedenle ilerleyen kısımlarda Hausdorff mesafesi üzerinden yapılan varyans kestirimi ile devam etmeye karar verdik.

\pagebreak
\clearpage